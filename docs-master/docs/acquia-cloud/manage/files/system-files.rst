.. include:: /common/global.rst

Accessing system files
======================

.. toctree::
   :hidden:
   :glob:

   /acquia-cloud/manage/files/system-files/*

This information on this page describes how you can view and access
various system files in your |acquia-product:ac| environments.

You can download your database backups using the **Databases** page in
the |acquia-product:ui|, as described in `Backing up your application:
Database backups </acquia-cloud/manage/back-up#db>`__. You can download
your logs using the **Logs** page, as described in `About
|acquia-product:ac| logging </acquia-cloud/monitor/logs>`__.

You can also access and transfer your files using ``SFTP``, ``scp``,
``rsync``, or SSH; connect using the full DNS name and not your
application URL host name. Also, sign in as your default (Unix) username
even if you assign the SSH key to a different username.

.. _locations:

File locations
--------------

You can access the file paths and directories for each of your
environments at the following locations:

Note

When using the paths listed in the following table, be sure to replace
these variables in the paths with values that describe your application:

-  ``[site]`` - Your application's site name
-  ``[env]`` - The alias for the environment, typically one of the
   following: ``dev`` (Development), ``test`` (Staging), or ``prod``
   (Production)
-  ``[sitedir]`` - Your application's folder in the
   ```[docroot]`` <%5Bacquia-product:kb%5Darticle/docroot-definition>`__\ ``/sites``
   directory. For more information, see `About Drupal multisite
   installations </acquia-cloud/multisite>`__
-  ``[servername]`` - The server associated with your application, which
   you can find on the **Servers** page for the environment
-  ``[logname]`` - The log file that you want to access (for a list of
   available log files, see `About |acquia-product:ac|
   logging </acquia-cloud/monitor/logs#location>`__)

+-----------------------+-----------------------+-----------------------+
| Area                  | Path                  | Description           |
+=======================+=======================+=======================+
| Public files          | ``/mnt/files/[site].[ | Root ``files``        |
|                       | env]/files``          | directory for public  |
|                       |                       | downloads             |
+-----------------------+-----------------------+-----------------------+
| Public files          | ``/mnt/files/[site].[ | Multisite ``files``   |
| (multisite)           | env]/sites/[sitedir]/ | directory for public  |
|                       | files``               | downloads for your    |
|                       |                       | application           |
+-----------------------+-----------------------+-----------------------+
| Private files         | ``/mnt/files/[site].[ | Root ``files``        |
|                       | env]/files-private``  | directory for private |
|                       |                       | downloads —           |
|                       |                       | `instructions to      |
|                       |                       | change the default    |
|                       |                       | path <#modify>`__     |
+-----------------------+-----------------------+-----------------------+
| Private files         | ``/mnt/files/[site].[ | Multisite ``files``   |
| (multisite)           | env]/sites/[sitedir]/ | directory for private |
|                       | files-private``       | downloads for your    |
|                       |                       | application —         |
|                       |                       | `instructions to      |
|                       |                       | change the default    |
|                       |                       | path <#modify>`__     |
+-----------------------+-----------------------+-----------------------+
| Temporary files       | ``/mnt/tmp/[site].[en | Ephemeral data        |
|                       | v]``                  | storage, per server,  |
|                       |                       | for temporary files   |
|                       |                       | generated by Drupal   |
|                       |                       | (for multi-server     |
|                       |                       | installations, see    |
|                       |                       | `Correcting broken    |
|                       |                       | file                  |
|                       |                       | uploads </acquia-clou |
|                       |                       | d/develop/files/broke |
|                       |                       | n>`__)                |
+-----------------------+-----------------------+-----------------------+
| Backups               | ``/mnt/files/[site].[ | Downloadable daily    |
|                       | env]/backups``        | and on-demand         |
|                       |                       | database backups      |
+-----------------------+-----------------------+-----------------------+
| Import                | ``/mnt/files/[site].[ | Files you upload to   |
|                       | env]/import``         | be imported into your |
|                       |                       | application           |
+-----------------------+-----------------------+-----------------------+
| Logs                  | ``/var/log/sites/[sit | Server log files (for |
|                       | e].[env]/logs/[server | more information, see |
|                       | name]/[logname].log`` | `About                |
|                       |                       | |acquia-product:ac|   |
|                       |                       | logging </acquia-clou |
|                       |                       | d/monitor/logs>`__)   |
+-----------------------+-----------------------+-----------------------+
| Live Development code | ``/mnt/gfs/[site].[en | Code repository for   |
| repository            | v]/www``              | your Live Development |
|                       |                       | (for more             |
|                       |                       | information, see      |
|                       |                       | `Using Live           |
|                       |                       | development mode to   |
|                       |                       | change code on your   |
|                       |                       | server </acquia-cloud |
|                       |                       | /develop/livedev>`__) |
+-----------------------+-----------------------+-----------------------+

.. _modify:

Modifying the private files directory
-------------------------------------

*|acquia-product:edg| subscribers should instead use the process
described at `Private files in
|acquia-product:edg| </site-factory/manage/files>`__.*

You can change the private files directory by setting the
``file_private_path`` variable in your application's ``settings.php``
file. Although the directory may be set to one of the
|acquia-product:ac| default locations described in the `previous
table <#locations>`__, it may also be set to
``/mnt/files/[site].[env]/sites/default/files-private`` (where
``[site]`` is the site name, ``[env]`` is the environment name, and
``[sitedir]`` is the directory for the multisite).

If you want to use a different location for private files, save the file
system form for all websites in all environments which, when processed,
will create the correct directories. To do this, complete the following
steps:

#. Add the following code to your website's ``settings.php`` file to
   detect both the Acquia environment and the current Drupal multisite:

   -  *Drupal 7*

      ``if (isset($_ENV['AH_SITE_ENVIRONMENT'])) {   $files_private_conf_path = conf_path();   $conf['file_private_path'] = '/mnt/files/' . $_ENV['AH_SITE_GROUP'] . '.' . $_ENV['AH_SITE_ENVIRONMENT'] . '/' . $files_private_conf_path . '/files-private'; } else {   $conf['file_private_path'] = '{PATH}'; }``

   -  *Drupal 8*

      ``if (isset($_ENV['AH_SITE_ENVIRONMENT'])) {   $settings['file_private_path'] = '/mnt/files/' . $_ENV['AH_SITE_GROUP'] . '.' . $_ENV['AH_SITE_ENVIRONMENT'] . '/' . $site_path . '/files-private'; } else {   $settings['file_private_path'] = '{PATH}'; }``

   where ``{PATH}`` is the path for the local server's private files
   directory.
   The code allows for a non-Acquia private files location to be set for
   working on a local server's copy of the website.
#. Save your ``settings.php`` file changes.
#. Sign in to your Drupal website as an administrator.
#. Navigate to **Configuration > Media > File system**
   (``http://[site_URL]/admin/config/media/file-system``).
#. Click **Save**.

The path for your private files directory can be found on this form in
the text area under **Private file system path**. |acquia-product:ac|
users can also set their private file directory to
``../acquia-files/files-private`` in the Drupal UI. This setting will
propagate across all their environments.

The private files directory is now saved and will persist unless
deleted. The act of saving a private files directory also creates an
``.htaccess`` file containing the command ``Deny from all``. That
command prevents the serving of files from the private directory.

Once the private file system path is saved, it can then be utilized by
fields. For example, you could add a file field to the ``Articles``
content type. As you configure this field, you will see that you (and
other website administrators) can choose the file's **Upload
destination** by selecting either **Public files** or **Private files**.
Files uploaded to this field are stored in your database's
``files_managed`` table with the ``private:`` protocol, instead of the
``public:`` protocol.

You can control access to files uploaded through a file field by
clearing the **Display** check box next to the file before publishing
the piece of content to which the file is attached. Because the file
will not display, users won't be able to click it. They also won't be
able to navigate directly to any files in the private directory.

For a more detailed level of access to private files, it may be
necessary to write custom modules that interact with the private file
system.

.. _related:

Related Topics
--------------

-  `Importing your files </acquia-cloud/create/import/manual-files>`__
-  `About |acquia-product:ac| logging </acquia-cloud/monitor/logs>`__
-  `Enabling SSH access </acquia-cloud/ssh/enable>`__
-  `About Drupal multisite installations </acquia-cloud/multisite>`__

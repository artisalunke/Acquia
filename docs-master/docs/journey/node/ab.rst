.. include:: /common/global.rst

Split Test node
===============

|Split Test node|

A Split Test node is a two-part node comprised two required parts: a
*Producer* and a *Consumer*. A *Producer* will assign a
randomly-selected variant to the transaction it is processing at that
time, and save two outputs: *Selected Variant* and *Consumer ID*.

The Split Test node can accomplish several tasks, including the
following:

-  Randomly select a variant for A/B or multivariate testing
-  Choose the winning variant that has been getting the most engagement
-  Reassign the probability of selecting a variant to favor the winner

For example, you can use a split test node to do the following actions:

-  Select Twitter responses
-  Select different subject lines and images for outgoing emails
-  Select different texts and images to display on a personalized
   website

For example, the following split test node has four variants: red, blue,
green, and yellow. The yellow variant is displayed more frequently, and
is the favored outcome:

|Split Test node example|

-  *Selected Variant* - The variant that was randomly selected by the
   node
-  *Consumer ID* - A hashed string generated by the *Producer* node and
   passed to the *Consumer* node to determine the winning variant

When implemented, a split test node performs the following actions:

#. The *Producer* node selects a variant and consumer ID
#. The *Producer* node pushes the variant (email, web page, twitter
   response) to the user
#. The user engages with the variant
#. The *Consumer* node tracks the user's engagement with the variant

Clicking the Producer node in the graph displays the Producer results
panel to the right of the page, which updates every 60 seconds.

|Producer results|

.. admonition:: Notes

  -  The number of iterations can be greater than the number of responses;
     for example, an email can be opened multiple times by the same
     recipient.
  -  Counts of iterations and responses value are only available in the
     results panel; they are not available in the schema or public
     variables.

Split test Options
------------------

You can enable one of the following options based on your use case:

-  Adaptive Learning
-  New Test on Deploy

Adaptive learning
~~~~~~~~~~~~~~~~~

By selecting the **Enable Adaptive Learning** check box, you can change
the distribution based on the winning variant, and reassign the
probability of selecting a variant to favor the winner.

|Adaptive Learning enabled|

-  **Minimum Iterations Produced** - The number of transactions that
   must be produced before variant distribution is adjusted based on
   adaptive learning. *(Default value: ``1000``)*
-  **Minimum Responses Consumed** - The number of transactions that must
   be consumed from the Minimum Iterations Produced before variant
   distribution is adjusted based on adaptive learning. *(Default value:
   ``100``)*
-  **Selection Certainty** - The confidence level required to select the
   winner. A lower number means the winner will be decided more quickly,
   but with less confidence. The winner is chosen using a `Chi-squared
   significance
   test <https://en.wikipedia.org/wiki/Chi-squared_test>`__. *(Default
   value: ``95``)*

After the **Minimum Responses Consumed** threshold is met, the node
selects variants based on the winning rank and the selection
distribution. In the previous example screenshot, after 10 responses are
received, a winner is chosen. The winner will be recommended 90% of the
time, then second place variant will be chosen 10% of the time.

Create new test on deploy
~~~~~~~~~~~~~~~~~~~~~~~~~

If you select the **Create New Test On Deploy** check box, the split
test node will be reset and all information (including the winning
variant) learned up to that point will be reset.

Creating a Split Test node
--------------------------

To create a Split Test node `as part of an existing
graph </journey/getting-started/graph>`__, perform the following
actions:

#. Sign in to |acquia-product:aj|.
#. Identify the project that you want to modify.
#. Click the **Project Editor** icon |Project Editor icon|.
#. In the top left of the page, click the action menu icon |Action Menu
   icon|, and then click **Create New**.
#. In the **Name** field, enter the name of your new Split Test node.
#. In the **Learning** section, click **Split Test**.

   |Create a Split Test node|

#. Click **Create New Item**.

.. note::
  You should create the *Producer* node in the process that determines the
  A/B group variant, while placing the *Consumer* node in the process that
  tracks engagement data.

Configuring a Split Test node
-----------------------------

After creating a blank Split Test node, perform the following actions to
configure it:

#. In the top right of the **Split Test Editor** section, click **Add
   Variant**.
#. Enter a name for the test, and then click **Save**.

   .. note::
     After you save a variant's name, you cannot edit the name.

#. To set the likelihood of this variant being selected, in the grey
   field to the right of the variant's name, enter a number between
   ``1`` and ``100``.

   |Setting a distribution|

#. In the top menu, click **Projects**.
#. Scroll through the list of projects, and identify the project to
   which you want to add the Split Test node.
#. Click the **Project Editor** icon |Project Editor icon|.
#. Double-click the graph that you want to edit.
#. In the dialog box, scroll to the **Learning** section, and then
   double-click your split test node.
#. Click the two-way arrow at the bottom-right corner of the split test
   node icon to indicate whether this node is a *Producer* or *Consumer*
   node.

   |Set a split test node in a graph|

Validation warnings
-------------------

+-----------------------------------+-----------------------------------+
| Warning                           | Solution                          |
+===================================+===================================+
| **Split test Meta Data must be    | Ensure that the 'Selected         |
| set to a valid data reference**   | Variant' and the 'Consumer ID'    |
|                                   | are saved to a location in the    |
|                                   | schema                            |
+-----------------------------------+-----------------------------------+
| **All split tests must have at    | Ensure that the Split Test node   |
| least 2 variants to be valid**    | has at least two variants to      |
|                                   | randomly select from for the A/B  |
|                                   | testing                           |
+-----------------------------------+-----------------------------------+
| **A project must have at least    | Ensure that a process in the      |
| one consumer node per split       | project has a Consumer node       |
| test**                            | version of the Split Test node to |
|                                   | identify a winning variant        |
+-----------------------------------+-----------------------------------+
| **A project can only have one     | Ensure that the same Split Test   |
| producer node per split test**    | node does not have two Producers  |
|                                   | in the same project               |
+-----------------------------------+-----------------------------------+

.. |Split Test node| image:: https://cdn3.webdamdb.com/1280_6GeJRo74Gkb8.png?1526476026
   :class: no-sb float-left logo-sm-lift
   :width: 51px
.. |Split Test node example| image:: https://cdn2.webdamdb.com/1280_Ab1GDRK9NV10.png?1526475980
   :width: 500px
   :height: 213px
.. |Producer results| image:: https://cdn2.webdamdb.com/1280_wpQpTSl9in11.png?1526476119
   :width: 292px
   :height: 225px
.. |Adaptive Learning enabled| image:: https://cdn3.webdamdb.com/1280_Yz0QtxBRB7n3.png?1526475642
   :width: 550px
   :height: 212px
.. |Project Editor icon| image:: https://cdn4.webdamdb.com/100th_sm_YcVG2zY8pZL5.png?1526475783
   :width: 33px
   :height: 29px
.. |Action Menu icon| image:: https://cdn3.webdamdb.com/100th_sm_Aa8wvVef08x7.png?1526475662
   :width: 26px
   :height: 22px
.. |Create a Split Test node| image:: https://cdn2.webdamdb.com/1280_wgPzczNllfj1.png?1526476144
   :width: 250px
   :height: 108px
.. |Setting a distribution| image:: https://cdn2.webdamdb.com/1280_sLMr1jHzyQl8.jpg?1526475756
   :width: 825px
   :height: 176px
.. |Set a split test node in a graph| image:: https://cdn2.webdamdb.com/1280_wwSuVl2yBOF9.jpg?1526475763
   :width: 480px
   :height: 456px

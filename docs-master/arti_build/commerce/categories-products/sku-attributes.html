
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SKU attributes, product options, and product categories &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Handling your Acquia Commerce Manager cart" href="../cart.html" />
    <link rel="prev" title="Product listings best practices" href="product-listings.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../../index.html">Home</a></li>
        
        <li><a href="../../commerce.html" >Acquia Commerce Manager</a></li>
        <li><a href="../categories-products.html" accesskey="U">Adding categories and products to Acquia Commerce Manager</a></li>
        <li class="current">SKU attributes, product options, and product categories</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../commerce.html">Acquia Commerce Manager</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../release-notes.html">Release notes - Acquia Commerce Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installing Acquia Commerce Manager and components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../terms.html">Acquia Commerce Manager terminology and fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html">Acquia Commerce Manager configuration settings</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../categories-products.html">Adding categories and products to Acquia Commerce Manager</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="displays.html">Managing product and SKU display</a></li>
<li class="toctree-l3"><a class="reference internal" href="product-listings.html">Product listings best practices</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SKU attributes, product options, and product categories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cart.html">Handling your Acquia Commerce Manager cart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../checkout.html">Checkout and payment methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../users.html">Managing users with Acquia Commerce Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../known-issues.html">Known issues in Acquia Commerce Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html">Troubleshooting Acquia Commerce Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html">Acquia Commerce Manager security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multilingual.html">Multilingual Acquia Commerce Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../promotions.html">Acquia Commerce Manager Promotions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">Acquia Commerce Manager API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="sku-attributes-product-options-and-product-categories">
<h1>SKU attributes, product options, and product categories<a class="headerlink" href="#sku-attributes-product-options-and-product-categories" title="Permalink to this headline">¶</a></h1>
<div class="internal-navigation docutils container">
<p><strong>Products &amp; SKUs</strong></p>
<ul class="simple">
<li>Attributes</li>
<li><a class="reference internal" href="displays.html"><span class="doc">Displays</span></a></li>
</ul>
</div>
<p>The SKU entity contains a multivalue field for attributes
(<code class="docutils literal"><span class="pre">field_attributes</span></code>) from your commerce platform. These fields contain
attribute names to attribute values in a <code class="docutils literal"><span class="pre">key:value</span></code> pair arrangement.
The value is typically the untranslated version of an attribute from the
commerce platform.</p>
<p>For example, <code class="docutils literal"><span class="pre">Color</span></code> is an attribute; in Drupal it will appear as
<code class="docutils literal"><span class="pre">color:</span> <span class="pre">444</span></code>, where <code class="docutils literal"><span class="pre">444</span></code> is the attribute ID for the color value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>By default, the attributes field is hidden from display by the user interface. To add the <code class="docutils literal"><span class="pre">field_attributes</span></code> field to the form display, edit the configuration for the SKU types.</li>
<li>Disabled SKUs are not stored in the system.</li>
</ul>
</div>
<p><strong>Product Options</strong> and <strong>Product Categories</strong> have special handling applied. Additional fields are added to the SKU that reference Drupal taxonomy terms in <strong>Product Option</strong> and <strong>Product Category</strong> vocabularies.</p>
<div class="section" id="special-handling-for-other-sku-attributes">
<h2>Special handling for other SKU attributes<a class="headerlink" href="#special-handling-for-other-sku-attributes" title="Permalink to this headline">¶</a></h2>
<p>If you want to apply similar special handling to attributes, you can do
so.</p>
<p>Although all attributes will be synchronised to Drupal in the
<code class="docutils literal"><span class="pre">field_attributes</span></code> field, you may need to expose some attributes
directly as fields. The main reason for doing this is to index actual
values to provide faceted search.</p>
<p>Fields can be added by extending the SKU entity definition in a custom
module by completing the following steps:</p>
<ol class="arabic simple">
<li>Add the new schema definitions to the <a class="reference external" href="https://www.drupal.org/docs/8/creating-custom-modules/include-default-configuration-in-your-drupal-8-module">default configuration of your
custom module</a>.</li>
<li>Provide an install hook to attach the definitions to the SKU entity.</li>
<li>Provide an entity presave hook to ensure that the fields get
populated during the import.</li>
</ol>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>As an example, refer to the following example to create a color special
attribute.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><em>Create a base fields configuration file (the schema).</em></div>
<div class="line">Here is an example that adds a color attribute to the SKU. This
should be saved as <code class="docutils literal"><span class="pre">my_module.sku_base_fields.yml</span></code>. This is how
we will access the configuration in the next steps).</div>
</div>
<div class="highlight-none"><div class="highlight"><pre><span></span>fields:
  color:
   parent: &#39;attributes&#39;
   label: &#39;Color&#39;
   description: &#39;Color attribute for the product.&#39;
   cardinality: -1
   type: &#39;attribute&#39;
   configurable: 0
   visible_view: 0
   visible_form: 1
</pre></div>
</div>
<p>Ensure that base field definitions are correct before adding them.
All properties are required.</p>
</li>
<li><div class="first line-block">
<div class="line"><em>Create an install hook.</em></div>
<div class="line">The install hook is required to call the
<code class="docutils literal"><span class="pre">acq_sku_add_base_fields</span></code> function with the configuration values
that are stored in the configuration files mentioned in the
previous step. An example install hook can appear similar to the
following:</div>
</div>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">function my_module_install() {</span>
<span class="x">  $fields = \Drupal::config(&#39;my_module.sku_base_fields&#39;)-&gt;get(&#39;fields&#39;);</span>
<span class="x">  acq_sku_add_base_fields($fields);</span>
<span class="x"> }</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><div class="first line-block">
<div class="line"><em>Create a presave hook to update your fields.</em></div>
<div class="line">If everything has been done correctly, the new fields will be
displayed when editing a SKU entity, and any new products that are
synced will update the fields based on their attributes. For simple
attributes, the base commerce module suite will update any values
that you have added to the SKU entity.</div>
<div class="line">You can define an entity presave hook to handle more complex
attributes (for example, configurable attributes). This gives you
complete control of the entity before it is saved, and you will
have access to the response from the Commerce Connector Service. To
continue with the example, the hook implementation should appear
similar to the following:</div>
</div>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">function my_module_acq_sku_presave(SKUInterface $sku) {</span>
<span class="x">   $configurable_attributes_data = unserialize($sku-&gt;get(&#39;field_configurable_attributes&#39;)-&gt;getString());</span>
<span class="x">      $fields = \Drupal::config(&#39;my_modules.sku_base_fields&#39;)-&gt;get(&#39;fields&#39;);</span>
<span class="x">      $opts = \Drupal::service(&#39;acq_sku.product_options_manager&#39;);    foreach ($fields as $field_key =&gt; $definition) {     $field_key = &quot;attr_$field_key&quot;;</span>
<span class="x">      foreach ($configurable_attributes_data as $attribute_data) {</span>
<span class="x">            if ($attribute_data[&#39;code&#39;] !== $key) {</span>
<span class="x">                continue;</span>
<span class="x">             }</span>
<span class="x">             foreach ($attribute_data[&#39;values&#39;] as $index =&gt; $value) {</span>
<span class="x">                $sku-&gt;get($field_key)-&gt;set($index, $value[&#39;value_id&#39;]);</span>
<span class="x">                if ($term = $opts&gt;loadProductOptionByOptionId($key, $value[&#39;value_id&#39;],</span>
<span class="x">                    $sku-&gt;language()-&gt;getId())) {</span>
<span class="x">                      $sku-&gt;get($field_key)-&gt;set($index, $term-&gt;getName());</span>
<span class="x">                      }</span>
<span class="x">                  }</span>
<span class="x">                }</span>
<span class="x">          }</span>
<span class="x">        }</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>You should now have custom attributes added to the SKU object and be
able to use them when displaying information or creating product
indexes.</p>
</div>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="product-listings.html" title="Product listings best practices"><b>‹&nbsp;</b>Product listings best practices</a>
            </div>
            
            <div class="next">
                <a href="../cart.html" title="Handling your Acquia Commerce Manager cart">Handling your Acquia Commerce Manager cart<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
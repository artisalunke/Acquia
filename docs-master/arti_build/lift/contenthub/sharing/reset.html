
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Resetting and reindexing entities by content type &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../../../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Keeping content synchronized" href="sync.html" />
    <link rel="prev" title="Importing multiple entities at once" href="import.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../../../index.html">Home</a></li>
        
        <li><a href="../../../lift.html" >Acquia Lift</a></li>
        <li><a href="../../contenthub.html" >Content Hub</a></li>
        <li><a href="../sharing.html" accesskey="U">Sharing content</a></li>
        <li class="current">Resetting and reindexing entities by content type</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../journey.html">Acquia Journey</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../lift.html">Acquia Lift</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../release-notes.html">Acquia Lift Component Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../known-issues.html">Known Issues in Acquia Lift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exp-builder.html">Experience Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../profile-mgr.html">Profile Manager</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../contenthub.html">Content Hub</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../service-rns.html">Release notes - Content Hub service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../client-rns.html">Release notes - Content Hub client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html">Installing Content Hub</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../sharing.html">Sharing content</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="blocks.html">Using blocks with Content Hub</a></li>
<li class="toctree-l4"><a class="reference internal" href="delete.html">Deleting content from subscribing sites</a></li>
<li class="toctree-l4"><a class="reference internal" href="dependencies.html">Working with content dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="export.html">Exporting multiple entities at once</a></li>
<li class="toctree-l4"><a class="reference internal" href="import.html">Importing multiple entities at once</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Resetting and reindexing entities by content type</a></li>
<li class="toctree-l4"><a class="reference internal" href="sync.html">Keeping content synchronized</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../discover.html">Discovering content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules.html">Modules to use with Content Hub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api.html">Using the Content Hub API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html">Content Hub troubleshooting guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices.html">Best practices for developing with Content Hub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cdf.html">Content Hub and CDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../devel.html">Using Devel with Content Hub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../drush.html">Using Drush with Content Hub for Drupal 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../drush-d8.html">Using Drush with Content Hub for Drupal 8</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../arch.html">Acquia Lift architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glossary.html">Acquia Lift glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../omni.html">Data warehouse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../connectors.html">Using connectors with Acquia Lift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html">Using the Acquia Lift APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="resetting-and-reindexing-entities-by-content-type">
<h1>Resetting and reindexing entities by content type<a class="headerlink" href="#resetting-and-reindexing-entities-by-content-type" title="Permalink to this headline">¶</a></h1>
<p>If you alter the content type configuration for a content type that you
are exporting to Content Hub, search mappings for that content
type may no longer correctly function. For example, after changing a
field from a list of names to an entity reference, the field now cannot
be used by Content Hub or indexed by the Elastic Search Index.</p>
<p>To address this, you can use the <code class="docutils literal"><span class="pre">ach-reset</span> <span class="pre">[entity_type]</span></code> Drush
command to clear all entities of that content type from
Content Hub, reset that content type’s mapping, reindex all
entities of the specified type, and then republish them back to
Content Hub.</p>
<p>For <code class="docutils literal"><span class="pre">ach-reset</span> <span class="pre">[entity_type]</span></code> to fully remove, reindex, and republish
all entities of a certain type, it must be executed <em>twice</em>. Before
executing, the command performs the following tests as a failsafe to
determine whether or not resetting and reindexing can proceed:</p>
<dl class="docutils">
<dt>Does this website have a registered webhook for notifications?</dt>
<dd>Without a registered webhook for notifications after the reindex
completes, the content will never begin the republishing process.</dd>
<dt>Is this entity type in use by multiple websites?</dt>
<dd>If yes, removing content will affect only content published by this
website, because a website cannot delete other websites’ content. You
must manually delete the content from the other websites using other
means, such as the <code class="docutils literal"><span class="pre">ach-delete</span></code> command. The <code class="docutils literal"><span class="pre">ach-reset</span></code> command
will provide you with a list of matching entities and their
originating websites.</dd>
<dt>Has the <code class="docutils literal"><span class="pre">reindex</span></code> state variable been set to** <code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Completed</span></code>?</dt>
<dd>When a reindex request is sent, the <code class="docutils literal"><span class="pre">reindex</span></code> variable is set to
<code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Sent</span></code>, and until the webhook notifies the website that the
reindexing process is complete (setting the variable to
<code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Completed</span></code>) Content Hub will accept no additional
reindexing requests.</dd>
</dl>
<div class="section" id="first-execution">
<h2>First execution<a class="headerlink" href="#first-execution" title="Permalink to this headline">¶</a></h2>
<p>If no <code class="docutils literal"><span class="pre">reindex</span></code> request currently exists, executing
<code class="docutils literal"><span class="pre">drush</span> <span class="pre">ach-reset</span></code> will cause Content Hub to perform the
following steps:</p>
<ol class="arabic simple">
<li>Mark all entitles of the specified type exported by this website for
later re-export.</li>
<li>Delete all entities of the specified type from Content Hub.
Note that as a result, entity mappings for Search are also deleted.</li>
<li>Trigger a <code class="docutils literal"><span class="pre">reindex</span></code> request using a webhook to Content Hub.</li>
<li>Set the <code class="docutils literal"><span class="pre">reindex</span></code> variable to <code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Sent</span></code>, which indicates
that the website is waiting for Content Hub to reindex all
content of the specified type.</li>
<li>Reindex all content of the specified type from this website.</li>
<li>Send a webhook to the website notifying it that the reindex is
complete.</li>
</ol>
<p>The website will change the <code class="docutils literal"><span class="pre">Reindex</span></code> state variable to
<code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Completed</span></code>, which cancels the <code class="docutils literal"><span class="pre">waiting</span></code> mode and indicates
that it is ready to re-export entities of the specified type to
Content Hub.</p>
</div>
<div class="section" id="second-execution">
<h2>Second execution<a class="headerlink" href="#second-execution" title="Permalink to this headline">¶</a></h2>
<p>For the second execution of <code class="docutils literal"><span class="pre">drush</span> <span class="pre">ach-reset</span></code>, if a <code class="docutils literal"><span class="pre">reindex</span></code>
request has been marked <code class="docutils literal"><span class="pre">Reindex</span> <span class="pre">Completed</span></code>, Content Hub will
use the Batch API to re-export the previously-deleted entities back into
Content Hub, using the current type mappings.</p>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="import.html" title="Importing multiple entities at once"><b>‹&nbsp;</b>Importing multiple entities at once</a>
            </div>
            
            <div class="next">
                <a href="sync.html" title="Keeping content synchronized">Keeping content synchronized<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
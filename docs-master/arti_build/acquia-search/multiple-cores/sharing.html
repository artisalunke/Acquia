
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Sharing Solr cores in read/write mode &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Troubleshooting multiple search cores" href="troubleshoot.html" />
    <link rel="prev" title="Overriding Solr core automatic connection switching" href="override.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../../index.html">Home</a></li>
        
        <li><a href="../../acquia-search.html" >Acquia Search</a></li>
        <li><a href="../multiple-cores.html" accesskey="U">Using multiple search cores</a></li>
        <li class="current">Sharing Solr cores in read/write mode</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../acquia-search.html">Acquia Search</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Modules for Acquia Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../activate.html">Getting started with Acquia Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html">Custom Solr configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../language.html">Selecting a language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../search-pages.html">Creating search pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../relevant-results.html">Obtaining relevant search results</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../multiple-cores.html">Using multiple search cores</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="override.html">Overriding Solr core automatic connection switching</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Sharing Solr cores in read/write mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshoot.html">Troubleshooting multiple search cores</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../multidomain.html">Searching across Drupal multisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">Acquia Search FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">Debugging Acquia Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../known-issues.html">Known issues in Acquia Search</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="sharing-solr-cores-in-read-write-mode">
<h1>Sharing Solr cores in read/write mode<a class="headerlink" href="#sharing-solr-cores-in-read-write-mode" title="Permalink to this headline">¶</a></h1>
<p>Multiple Acquia Search cores</p>
<ul class="simple">
<li><a class="reference external" href="/acquia-search/multiple-cores">Use</a></li>
<li><a class="reference external" href="/acquia-search/multiple-cores/override">Override</a></li>
<li>Share</li>
<li><a class="reference external" href="/acquia-search/multiple-cores/troubleshoot">Troubleshoot</a></li>
</ul>
<p>With all of the benefits of allowing multiple websites to write to a
single Solr instance, there are some inherent areas of concern in doing
so. Potential problems can include accidental Solr core pollution (such
as a development website writing to a production index) and accidental
deletion when trying to remove a non-production index.</p>
<p>However, the following methods can help you share Solr cores safely,
which can ensure that your website is able to service users:</p>
<ul class="simple">
<li><strong>Consider using read-only mode</strong>
Ensure that your application actually needs to write to a Solr core;
in some cases, reading is sufficient. For example, if your
development and production websites have the same content, you can
use the production index in read-only mode for search.</li>
<li><strong>Ensure correct implementation of Solr hashes</strong>
Solr-related Drupal modules (including <a class="reference external" href="https://www.drupal.org/project/apachesolr_multisitesearch">Apache Solr Multisite
Search</a>
and recent versions of <a class="reference external" href="https://www.drupal.org/project/search_api_solr">Search API Solr
Search</a>) should
tag all indexed items with a unique string ID called a <em>hash</em>. This
hash value should be unique to each website that writes to the same
Solr core, allowing you to logically share a single Solr core across
websites. All queries, indexing, and delete operations are limited to
items that have this hash value.
Because of this, problems can occur when moving a Drupal database.
Hash values are created when the module is installed, and are stored
as configuration data in Drupal’s database. Moving a database to
another environment can include configuration data (and by extension,
the hash values). To resolve this, we recommend that you override the
hash value in code. To review your hash values, examine the following
items:<ul>
<li><a class="reference external" href="https://www.drupal.org/project/search_api_solr">Search API Solr
Search</a> module
(Drupal 8) - <code class="docutils literal"><span class="pre">search_api_solr.settings:site_hash</span></code> configuration
setting</li>
<li><a class="reference external" href="https://www.drupal.org/project/search_api_solr">Search API Solr
Search</a> module
(Drupal 7) - <code class="docutils literal"><span class="pre">search_api_solr_site_hash</span></code> variable</li>
<li><a class="reference external" href="https://www.drupal.org/project/apachesolr">Apache Solr Search</a>
module (Drupal 7) - <code class="docutils literal"><span class="pre">apachesolr_site_hash</span></code> variable</li>
</ul>
</li>
<li><strong>Use tools to understand your index</strong>
Tools such as <a class="reference external" href="https://www.drupal.org/project/solr_devel">Solr
Devel</a> (for Drupal 7)
enable you to both examine outgoing queries and understand the data
in your index. For information about using Solr Devel, see <a class="reference external" href="%5Bacquia-product:kb%5Darticle/using-solr-devel-module-debug-acquia-search-indexing-and-queries">Using
Solr Devel module to debug |acquia-product:as| indexing and
queries</a>.</li>
<li><strong>Be prepared to delete data and reindex</strong>
If a single Solr core is polluted with data from unintended sources,
it can be difficult to fix. This is because Drupal keeps tracking
information about what it thinks it has already indexed in the
database, separate from the actual Solr data.
To recover from this issue, and to help prevent future pollution,
complete the following steps:<ol class="arabic">
<li>Ensure that you close any connections from unwanted websites
writing to the target Solr core.</li>
<li>Completely wipe data from the target Solr core.</li>
<li>Reindex all of the data that needs to be written to this Solr
core.</li>
</ol>
</li>
</ul>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="override.html" title="Overriding Solr core automatic connection switching"><b>‹&nbsp;</b>Overriding Solr core automatic connection switching</a>
            </div>
            
            <div class="next">
                <a href="troubleshoot.html" title="Troubleshooting multiple search cores">Troubleshooting multiple search cores<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
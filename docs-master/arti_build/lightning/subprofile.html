
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lightning sub-profiles &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Updating Lightning" href="update.html" />
    <link rel="prev" title="Lightning roles" href="roles.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../index.html">Home</a></li>
        
        <li><a href="../lightning.html" >Lightning</a></li>
        <li><a href="modules.html" accesskey="U">Module listing for Lightning</a></li>
        <li class="current">Lightning sub-profiles</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools.html">Developer tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../lightning.html">Lightning</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">Module listing for Lightning</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="experimental.html">Lightning experimental modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="extend.html">Extending Lightning</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html">Installing Lightning</a></li>
<li class="toctree-l3"><a class="reference internal" href="known-issues.html">Known issues in Lightning</a></li>
<li class="toctree-l3"><a class="reference internal" href="release-notes.html">Release notes - Lightning</a></li>
<li class="toctree-l3"><a class="reference internal" href="roles.html">Lightning roles</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Lightning sub-profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="update.html">Updating Lightning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installing Lightning</a></li>
<li class="toctree-l2"><a class="reference internal" href="update.html">Updating Lightning</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lightning sub-profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="known-issues.html">Known issues in Lightning</a></li>
<li class="toctree-l2"><a class="reference internal" href="experimental.html">Lightning experimental modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="extend.html">Extending Lightning</a></li>
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">Release notes - Lightning</a></li>
<li class="toctree-l2"><a class="reference internal" href="roles.html">Lightning roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="lightning-sub-profiles">
<h1>Lightning sub-profiles<a class="headerlink" href="#lightning-sub-profiles" title="Permalink to this headline">¶</a></h1>
<p>Lightning includes the ability to create sub-profiles that are
based on the default Lightning distribution profile. Making a
sub-profile allows you to customize the installation process to meet one
or more of your specific needs.</p>
<p>If any of the following are true, you should create a sub-profile of
Lightning:</p>
<ul class="simple">
<li>You want to prevent some component or subcomponent of
Lightning from being installed.</li>
<li>You want to enable additional modules, themes, or configuration
during install.</li>
<li>You want to customize the look and feel of the installation process.</li>
<li>You want to build a distribution that offloads modules such as Media,
Layout, and Workflow to Lightning.</li>
<li>You previously used <code class="docutils literal"><span class="pre">lightning.extend.yml</span></code> to accomplish any of the
previous items.</li>
</ul>
<div class="section" id="creating-a-sub-profile">
<h2>Creating a sub-profile<a class="headerlink" href="#creating-a-sub-profile" title="Permalink to this headline">¶</a></h2>
<p>Select from the following three primary methods to create a
Lightning sub-profile:</p>
<ul class="simple">
<li><a class="reference external" href="#generating-a-new-lightning-sub-profile">Generate a new sub-profile</a></li>
<li><a class="reference external" href="#converting-lightning-extend-yml-to-a-sub-profile">Convert lightning.extend.yml into a sub-profile</a></li>
<li><a class="reference external" href="#switching-an-existing-sites-install-profile-from-lightning-to-a-sub-profile">Switch an existing site’s install profile from Lightning to a sub-profile</a></li>
</ul>
<div class="section" id="generating-a-new-lightning-sub-profile">
<h3>Generating a new Lightning sub-profile<a class="headerlink" href="#generating-a-new-lightning-sub-profile" title="Permalink to this headline">¶</a></h3>
<p>For simple use cases, such as wanting to exclude some
Lightning components or include a few of your own, you can use
the provided sub-profile generator.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The generator is also a good starting point for more complex sub-profiles.</p>
</div>
<div class="section" id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h4>
<p>To run the sub-profile generator, the following items are required for
your application:</p>
<ul class="simple">
<li><a class="reference external" href="https://drupalconsole.com/">DrupalConsole</a></li>
<li>Lightning version 2.0.4 and greater</li>
<li>An installed instance of Lightning or Drupal</li>
</ul>
</div>
<div class="section" id="running-the-generator">
<h4>Running the generator<a class="headerlink" href="#running-the-generator" title="Permalink to this headline">¶</a></h4>
<p>After you have ensured that your application meets the previous
requirements, run the following command from your installation’s
<a class="reference external" href="%5Bacquia-product:kb%5Darticles/docroot-definition">docroot</a>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>drupal lightning:subprofile
</pre></div>
</div>
</div>
</div>
<div class="section" id="converting-lightning-extend-yml-to-a-sub-profile">
<h3>Converting <code class="docutils literal"><span class="pre">lightning.extend.yml</span></code> to a sub-profile<a class="headerlink" href="#converting-lightning-extend-yml-to-a-sub-profile" title="Permalink to this headline">¶</a></h3>
<p>If you have previously used the Lightning extend file
(<code class="docutils literal"><span class="pre">lightning.extend.yml</span></code>), you can also convert the file to a
sub-profile.</p>
<div class="section" id="id1">
<h4>Requirements<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>To run the conversion, the following items are required for your
application:</p>
<ul class="simple">
<li><a class="reference external" href="https://drupalconsole.com/">DrupalConsole</a></li>
<li>Lightning version 2.0.4 and greater</li>
<li>An installed instance of Lightning or Drupal</li>
</ul>
</div>
<div class="section" id="running-the-conversion">
<h4>Running the conversion<a class="headerlink" href="#running-the-conversion" title="Permalink to this headline">¶</a></h4>
<p>To convert the subfile, run the following command from your
installation’s
<a class="reference external" href="%5Bacquia-product:kb%5Darticles/docroot-definition">docroot</a>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>./vendor/bin/lightning-subprofile /path/to/your/extend/file/lightning.extend.yml
</pre></div>
</div>
</div>
</div>
<div class="section" id="switching-an-existing-sites-install-profile-from-lightning-to-a-sub-profile">
<h3>Switching an existing site’s install profile from Lightning to a sub-profile<a class="headerlink" href="#switching-an-existing-sites-install-profile-from-lightning-to-a-sub-profile" title="Permalink to this headline">¶</a></h3>
<p>To do this, complete the following steps:</p>
<ol class="arabic">
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">settings.php</span></code>.</p>
</li>
<li><p class="first">In the file, add or update the <code class="docutils literal"><span class="pre">install_profile</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$settings[&#39;install_profile&#39;] = &#39;[SUB-PROFILE_NAME]&#39;;
</pre></div>
</div>
</li>
<li><p class="first">Run the following command to enable the profile:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>drush cset core.extension module.[SUB-PROFILE_NAME] 0
</pre></div>
</div>
</li>
<li><p class="first">If you use CMI or have exported the <code class="docutils literal"><span class="pre">core.extension.yml</span></code>, export
the updated extension listing to file.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="comparing-sub-profiles-and-the-lightning-extend-yml-file">
<h2>Comparing sub-profiles and the <code class="docutils literal"><span class="pre">lightning.extend.yml</span></code> file<a class="headerlink" href="#comparing-sub-profiles-and-the-lightning-extend-yml-file" title="Permalink to this headline">¶</a></h2>
<p>Versions of Lightning prior to 8.x-2.05 included the
<code class="docutils literal"><span class="pre">lightning.extend.yml</span></code> file, and installed modules in the following
order:</p>
<ul class="simple">
<li>core modules</li>
<li>Lightning modules</li>
<li>extend modules</li>
</ul>
<p>Extend modules were installed in the order that they were listed in the
extend file.</p>
<p>As of version 2.05, Lightning defers to the core install
system to determine when modules get installed. With this change, users
cannot rely on all of the modules in Lightning being installed
by the time your additional dependencies are installed. By design,
optional configurations are not installed until the end of the
installation process. Any attempt to modify optional configurations
should happen with <code class="docutils literal"><span class="pre">hook_ENTITY_presave</span></code> rather than <code class="docutils literal"><span class="pre">hook_install</span></code>
or similar.</p>
<p>If this causes problems during your installation, one resolution method
is to remove the dependencies from your <code class="docutils literal"><span class="pre">subprofile.info.yml</span></code> file,
and then move them into an install hook in your sub-profile’s install
file. For example:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">$modules = [</span>
<span class="x">    &#39;mymodule&#39;,</span>
<span class="x">    &#39;foo&#39;,</span>
<span class="x">    &#39;bar&#39;,</span>
<span class="x">    // ...</span>
<span class="x">];</span>
<span class="x">foreach ($modules as $module) {</span>
<span class="x">    \Drupal::service(&#39;module_installer&#39;)-&gt;install([$module]);</span>
<span class="x">}</span>
</pre></div>
</div>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="roles.html" title="Lightning roles"><b>‹&nbsp;</b>Lightning roles</a>
            </div>
            
            <div class="next">
                <a href="update.html" title="Updating Lightning">Updating Lightning<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
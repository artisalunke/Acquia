
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Custom Varnish configuration for Acquia Cloud Enterprise applications &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../../../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Varnish headers" href="headers.html" />
    <link rel="prev" title="Using Varnish" href="../varnish.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../../../index.html">Home</a></li>
        
        <li><a href="../../../acquia-cloud.html" >Acquia Cloud</a></li>
        <li><a href="../../performance.html" >Improving application performance</a></li>
        <li><a href="../varnish.html" accesskey="U">Using Varnish</a></li>
        <li class="current">Custom Varnish configuration for Acquia Cloud Enterprise applications</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../acquia-cloud.html">Acquia Cloud</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../free.html">Getting started with Acquia Cloud Free</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cloud-ui.html">Using the Acquia Cloud interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arch.html">Acquia Cloud architecture and key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ready.html">Acquia Cloud onboarding guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../create.html">Creating a new application on Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manage.html">Managing applications with Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../monitor.html">Monitoring your applications and infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../access.html">Controlling access to Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../insight.html">Acquia Insight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../develop.html">Developing applications on Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../node-js.html">Node.js and Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../container.html">Containers in Acquia Cloud</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../performance.html">Improving application performance</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../load.html">Load and stress testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../load-requirements.html">Load testing requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../memcached.html">Using Memcached</a></li>
<li class="toctree-l3"><a class="reference internal" href="../php-timeouts.html">Troubleshooting PHP timeouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../request-log.html">Analyzing the Drupal request log</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../varnish.html">Using Varnish</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Custom Varnish configuration for Acquia Cloud Enterprise applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="headers.html">Varnish headers</a></li>
<li class="toctree-l4"><a class="reference internal" href="manually-purge.html">Manually purging a page from Varnish cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="purging.html">Purging Varnish cache on Acquia Cloud</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../subs.html">Managing subscriptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cd.html">Acquia Cloud CD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glossary.html">Acquia Cloud glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../known-issues.html">Known issues in Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release-notes.html">Release notes - Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../self-service-scaling.html">Using a Cloud Service Management plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ssl.html">Enabling SSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../teams.html">Managing users, teams, roles, and permissions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="custom-varnish-configuration-for-acquia-product-ace-applications">
<h1>Custom Varnish configuration for Acquia Cloud Enterprise applications<a class="headerlink" href="#custom-varnish-configuration-for-acquia-product-ace-applications" title="Permalink to this headline">¶</a></h1>
<p>This page describes how to implement custom Varnish® configurations,
which are available only for Acquia Cloud Enterprise applications that have
dedicated load balancers.</p>
<p>Varnish Cache is a caching reverse proxy that is installed in front of
all Acquia Cloud load balancing servers. For more information,
see <a class="reference external" href="/acquia-cloud/performance/varnish">Using Varnish</a>. Varnish Cache
is configured with its own domain-specific programming language,
<a class="reference external" href="https://www.varnish-cache.org/trac/wiki/VCL">VCL</a>. If you are
interested in deploying a custom Varnish configuration, contact Acquia
Support. Acquia will provide you with a test environment for one week to
test your new custom VCL, but coding and testing is the customer’s
responsibility. For more complex changes, consider purchasing an Acquia
Professional Services engagement.</p>
<p>Acquia Cloud Enterprise customers can <a class="reference external" href="/support#contact">contact Acquia
Support</a> to create a support ticket to request a
copy of the full VCL, based on their contractual NDA. Acquia does <em>not</em>
disclose the configuration of our Nginx servers, as the configuration is
both proprietary and subject to change without notice.</p>
<div class="section" id="custom-varnish-configuration-schedule">
<span id="schedule"></span><h2>Custom Varnish configuration schedule<a class="headerlink" href="#custom-varnish-configuration-schedule" title="Permalink to this headline">¶</a></h2>
<p>Acquia deploys custom Varnish configurations on a weekly schedule. To
deploy your custom Varnish configuration, you must meet the following
weekly schedule:</p>
<ol class="arabic">
<li><p class="first">Request a copy of your current VCL from Acquia.</p>
</li>
<li><p class="first">Supply Acquia the list of environments in front of which you want to
place the test load balancer.</p>
</li>
<li><p class="first">Supply your new VCL file no later than 12:00 Eastern (North America)
Time (<a class="reference external" href="http://www.worldtimebuddy.com/utc-to-est-converter">find UTC
equivalent</a>)
on Monday. You must supply the entire VCL file, and not only the
lines that are changing.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">VCL files on Acquia Cloud are limited to a maximum of 128KB in
size.</p>
</div>
</li>
<li><p class="first">Acquia deploys a test load balancer with the new VCL no later than
17:00 Eastern (North America) Time on Tuesday. You should then test
to verify that the functionality is working as desired. To test the
VCL on the test load balancer, it may be helpful to <a class="reference external" href="https://support.acquia.com/hc/en-us/search?utf8=%E2%9C%93&amp;query=/using-etchosts-file-custom-domains-during-development">modify the
/etc/hosts file on your local
computer</a>
to point to the IP address of the test load balancer.</p>
</li>
<li><p class="first">If you encounter any issues that require a revised VCL, you must
submit a revised VCL no later than 09:00 Eastern (North America) Time
on Wednesday for Acquia to apply the revised VCL to the test load
balancer.</p>
</li>
<li><p class="first">You must complete any testing and confirm your approval no later than
15:00 Eastern (North America) Time on Wednesday.</p>
</li>
<li><p class="first">Acquia performs code reviews between 15:00 Eastern (North America)
Time on Wednesday and 15:00 Eastern (North America) Time on Thursday.</p>
</li>
<li><p class="first">Acquia begins to deploy all VCLs that have been approved both by the
customer and by Acquia starting at 15:00 Eastern (North America) Time
on Thursday.</p>
</li>
</ol>
</div>
<div class="section" id="custom-varnish-configuration-use-cases">
<span id="usecase"></span><h2>Custom Varnish configuration use cases<a class="headerlink" href="#custom-varnish-configuration-use-cases" title="Permalink to this headline">¶</a></h2>
<p>Here are some examples of use cases for which custom Varnish
configurations can be useful:</p>
<ul class="simple">
<li>Changes to IP access control lists (ACLs)</li>
<li>Device-based redirection (however, <a class="reference external" href="/acquia-cloud/develop/mobile">using
.htaccess</a> instead of custom Varnish
configuration is a more flexible approach)</li>
<li>Caching 404 responses</li>
</ul>
<div class="section" id="unsupported-use-cases">
<h3>Unsupported use cases<a class="headerlink" href="#unsupported-use-cases" title="Permalink to this headline">¶</a></h3>
<p>Acquia does not support the following types of Varnish configuration use
cases:</p>
<ul class="simple">
<li>Inline C in custom VCLs</li>
<li>Customer-requested Varnish
<a class="reference external" href="https://www.varnish-cache.org/vmods/">VMODs</a></li>
</ul>
</div>
</div>
<div class="section" id="related-topics">
<span id="related"></span><h2>Related topics<a class="headerlink" href="#related-topics" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="/acquia-cloud/performance/varnish">Using Varnish</a></li>
<li><a class="reference external" href="%5Bacquia-product:kb%5Darticles/varnish-intro">Introduction to
Varnish</a></li>
<li><a class="reference external" href="%5Bacquia-product:kb%5Darticles/simplified-vcl-varnish">Simplified VCL for
Varnish</a></li>
<li><a class="reference external" href="%https://support.acquia.com/hc/en-us/search?utf8=%E2%9C%93&amp;query=/using-etchosts-file-custom-domains-during-development">Using an /etc/hosts file for custom domains during
development</a></li>
</ul>
<p><em>Varnish is a registered trademark of Varnish Software AB and its
affiliates.</em></p>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="../varnish.html" title="Using Varnish"><b>‹&nbsp;</b>Using Varnish</a>
            </div>
            
            <div class="next">
                <a href="headers.html" title="Varnish headers">Varnish headers<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
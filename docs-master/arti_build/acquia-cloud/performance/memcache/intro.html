
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Memcached and Acquia hosting &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../../../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../../../index.html">Home</a></li>
        
        <li class="current">Memcached and Acquia hosting</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../site-factory.html">Acquia Cloud Site Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="memcached-and-acquia-hosting">
<h1>Memcached and Acquia hosting<a class="headerlink" href="#memcached-and-acquia-hosting" title="Permalink to this headline">¶</a></h1>
<p>About Memcached</p>
<ul class="simple">
<li>Intro</li>
<li><a class="reference external" href="/acquia-cloud/memcache/pecl">PECL</a></li>
<li><a class="reference external" href="/acquia-cloud/memcache/drupal">Drupal</a></li>
</ul>
<p>Memcached plays a critical role in any Drupal website’s<a class="reference external" href="/acquia-cloud/performance/memcached">caching
strategy on Acquia’s</a> hosting
platform. Memcached may seem like a black box, but with a little
research, we can demystify many of its confusing aspects.</p>
<p>There are four major pieces that comprise Acquia’s Memcached solution:
Drupal core, the Memcache API and Integration module, the PECL memcache
PHP extension, and the Memcached service.</p>
<p><a class="align-center no-sb reference internal" href="https://cdn3.webdamdb.com/md_kBTuJADcdb91.png?1526475495"><img alt="memcache stack" class="align-center no-sb" src="https://cdn3.webdamdb.com/md_kBTuJADcdb91.png?1526475495" style="width: 331px; height: 364px;" /></a></p>
<div class="section" id="memcached-service">
<span id="memcached"></span><h2>Memcached service<a class="headerlink" href="#memcached-service" title="Permalink to this headline">¶</a></h2>
<p>Memcached is a service with several components that work together to
ensure stability and uptime for a website.</p>
<div class="section" id="key-value-storage">
<span id="key-value"></span><h3>Key/Value storage<a class="headerlink" href="#key-value-storage" title="Permalink to this headline">¶</a></h3>
<p>Memcached is a <em>key-value store</em>, which is a data storage paradigm
designed for storing, retrieving, and managing associative arrays —
commonly known as a <em>hash</em>. This contrasts with relational database
object models that enable advanced concepts such as mapping and
datatypes.</p>
</div>
<div class="section" id="protocols">
<h3>Protocols<a class="headerlink" href="#protocols" title="Permalink to this headline">¶</a></h3>
<p>Acquia’s memcache configuration uses a small group of commands for
handling data in Memcached storage:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">get</span></code> - Retrieve an existing item from storage.</li>
<li><code class="docutils literal"><span class="pre">set</span></code> - Save a new item to storage.</li>
<li><code class="docutils literal"><span class="pre">flush_all</span></code> - Mark an item as <code class="docutils literal"><span class="pre">expired</span></code> so that it cannot be
retrieved. This method pushes the current item to the front of the
line, to be replaced by the next cacheable item. It does not free the
memory used by that item.</li>
<li><code class="docutils literal"><span class="pre">delete</span></code> - Remove an item from storage.</li>
<li><code class="docutils literal"><span class="pre">stats</span></code> - Query the service for aggregated data about the objects
saved to storage.</li>
</ul>
</div>
<div class="section" id="memory-partitioning">
<span id="partition"></span><h3>Memory partitioning<a class="headerlink" href="#memory-partitioning" title="Permalink to this headline">¶</a></h3>
<p>When the Memcached daemon is started, it reserves memory for object
storage (by default, 64MB). The memory allocated is divided into 1MB
<em>pages</em>, which by default provides 64 pages. Memcached initializes a
memory organization concept called a <em>slab</em> class on startup. A slab
defines the number of items (chunks) which can be inserted into a 1MB
memory page. By dividing 1MB by that number of chunks, you can determine
that slab’s chunk size.</p>
<p>By default, Memcached creates 42 slabs and assigns a single page to
each. Each successive slab holds fewer, larger chunks based on the
<em>factor</em> (by default, 1.25). In the following sample representation of
slabs, notice that the item size (or chunk size) increases by a factor
of 1.25 from the second to the third slab:</p>
<p><code class="docutils literal"><span class="pre">#</span>&#160;&#160; <span class="pre">Item_Size</span>&#160; <span class="pre">Max_age</span>&#160;&#160; <span class="pre">Pages</span>&#160;&#160; <span class="pre">Count</span>&#160;&#160; <span class="pre">Full?</span>&#160; <span class="pre">Evicted</span> <span class="pre">Evict_Time</span> <span class="pre">OOM</span>&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">120B</span>&#160;&#160; <span class="pre">1168824s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">170</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">no</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160; <span class="pre">0</span>&#160; <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">152B</span>&#160;&#160; <span class="pre">1831103s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">196</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">no</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160; <span class="pre">0</span>&#160; <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">192B</span>&#160;&#160; <span class="pre">1847211s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">988</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">30</span>&#160;&#160;&#160;&#160; <span class="pre">9183</span>&#160;&#160;&#160; <span class="pre">0</span> <span class="pre">...</span> <span class="pre">36</span>&#160;&#160; <span class="pre">246.8K</span>&#160;&#160;&#160;&#160; <span class="pre">27236s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">6</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">21</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">7</span>&#160;&#160;&#160;&#160; <span class="pre">2676</span>&#160;&#160;&#160; <span class="pre">0</span> <span class="pre">37</span>&#160;&#160; <span class="pre">308.5K</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">1224s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">91</span>&#160;&#160;&#160; <span class="pre">29174</span>&#160;&#160;&#160; <span class="pre">0</span> <span class="pre">...</span> <span class="pre">40</span>&#160;&#160; <span class="pre">602.5K</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">1696s</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">11</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">0</span>&#160;&#160;&#160; <span class="pre">0</span> <span class="pre">41</span>&#160;&#160; <span class="pre">753.1K</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">64s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">6</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">35</span>&#160;&#160;&#160; <span class="pre">0</span> <span class="pre">42</span>&#160; <span class="pre">1024.0K</span>&#160;&#160;&#160;&#160; <span class="pre">44944s</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160;&#160;&#160; <span class="pre">yes</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">20</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160;&#160; <span class="pre">20</span></code></p>
<p>Memcached saves items by evaluating an item’s size, and then writing it
to a slab. In the previous example, note that slab 37 contains items
that range in size from 246.8KB to 308.5KB.</p>
<p>When a slab cannot fit a new item and there is additional memory
available to Memcached, a new page will be assigned to the slab. In the
previous example, slab 37 can contain at most four items, but, depending
on the items’ size, may contain only three items:</p>
<ul class="simple">
<li>If objects are 248KB, four items equals 992K, which is less than 1MB.</li>
<li>If objects are 300KB, because four items equals 1.2MB, after three
items a new page is created.</li>
</ul>
<p>When the <code class="docutils literal"><span class="pre">set()</span></code> method is called, Memcached determines the size of
the object, and then locates the slab with the appropriate memory
allocation.</p>
</div>
<div class="section" id="memory-management">
<span id="memory"></span><h3>Memory management<a class="headerlink" href="#memory-management" title="Permalink to this headline">¶</a></h3>
<p>Each Memcached server is configured to manage its memory with Least
Recently Used (LRU) prioritization. The servers oversee their local slab
arrays, producing a list of candidates for removal. When a new item is
assigned to a full slab and there are no free pages to assign to that
slab, the full slab evicts the LRU item from the same slab. This is both
healthy and accepted behavior — assuming that the objects being evicted
are outdated and due to be safely removed.</p>
</div>
<div class="section" id="scaling">
<span id="scale"></span><h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h3>
<p>Memcached does not internally provide mechanisms for adding capacity
through additional processes. Instead, this functionality is handled
entirely by an external client, such as the <a class="reference external" href="/acquia-cloud/memcache/pecl">PECL memcache extension for
PHP</a>.</p>
</div>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="../../../genindex.html" title="General Index"><b>‹&nbsp;</b>General Index</a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>
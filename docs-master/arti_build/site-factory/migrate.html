
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Preparing to migrate sites into Acquia Cloud Site Factory &#8212; Acquia Help Center</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/foundation-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/what-input/what-input.min.js"></script>
    <script type="text/javascript" src="../_static/foundation-sites/foundation.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Executing a migration into Acquia Cloud Site Factory" href="migrate/execute.html" />
    <link rel="prev" title="Auditing Acquia Cloud Site Factory events" href="monitor/auditlog.html" /> 
  </head>
  <body>

    
<header>
<div class="topbar">
    <div class="col left">
        <a href="/" title="Acquia Help Center Home" class="logo">Acquia Help Center</a>
    </div>
    <div class="col right">
      <ul class="main-nav">
        <li>
          <a href="https://www.acquia.com" title="Go to www.acquia.com for our latest information.">Acquia.com</a>
        </li>
        <li>
            <a href="https://dev.acquia.com" title="Acquia's Developer Center: developers.acquia.com">Developers</a>
        </li>
        <li>
            <a href="https://training.acquia.com" title="Go to training.acquia.com to find out about courses and certifications.">Training</a>
        </li>
        <li>
            <a href="/site-search" data-drupal-link-system-path="site-search">Search</a>
        </li>
      </ul>
    </div>
</div>
<div class="bottombar">
    <div class="searchbar-wrapper">
        <form action="search.html" method="get" class="searchbar">
            <div class="search-title">Need help finding something? <strong>Start Here.</strong></div>
            <div class="search-box">
                <input type="search" name="q" maxlength="128" size="15" value="" class="st-default-search-input">
                <input type="hidden" name="check_keywords" value="yes">
                <input type="hidden" name="area" value="default">
            </div>
            <div class="search-btn">
                <input class="btn-search button" type="submit" id="edit-submit-acquia-search" value="Search Docs">
            </div>
        </form>
    </div>
	</div>
</header>



    
<div class="breadcrumbs-wrapper">
	<ul>
        
        <li><a href="../index.html">Home</a></li>
        
        <li><a href="../site-factory.html" accesskey="U">Acquia Cloud Site Factory</a></li>
        <li class="current">Preparing to migrate sites into Acquia Cloud Site Factory</li>
	</ul>
</div>


<div class="row">
    
        
  <div class="small-4 large-3 columns" id="sidebar" data-sticky-container>
      <div class="sticky" data-sticky data-margin-top="0"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../acquia-cloud.html">Acquia Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../edge.html">Acquia Cloud Edge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shield.html">Acquia Cloud Shield</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../site-factory.html">Acquia Cloud Site Factory</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="release-notes.html">Release notes - Acquia Cloud Site Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="compare.html">Acquia Cloud Site Factory and Drupal</a></li>
<li class="toctree-l2"><a class="reference internal" href="acquia-cloud.html">Acquia Cloud Site Factory and Acquia Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="extend.html">Extending Acquia Cloud Site Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="governance.html">Governance on Acquia Cloud Site Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitor.html">Monitoring Acquia Cloud Site Factory</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Preparing to migrate sites into Acquia Cloud Site Factory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="migrate/execute.html">Executing a migration into Acquia Cloud Site Factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="migrate/plan.html">Checklist for migrating your sites to Acquia Cloud Site Factory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setting up your Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow.html">Workflows in Acquia Cloud Site Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacks.html">Using Site Factory Stacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="manage.html">Managing your Acquia Cloud Site Factory sites</a></li>
<li class="toctree-l2"><a class="reference internal" href="theme.html">Customizing site appearance</a></li>
<li class="toctree-l2"><a class="reference internal" href="known-issues.html">Known issues in Acquia Cloud Site Factory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commerce.html">Acquia Commerce Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dam.html">Acquia DAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-desktop.html">Acquia Dev Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../journey.html">Acquia Journey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lift.html">Acquia Lift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Acquia Platform APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acquia-search.html">Acquia Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools.html">Developer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lightning.html">Lightning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Acquia Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ra.html">Remote Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resource.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Acquia Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Products and Services Guide</a></li>
</ul>

      </div>
  </div>
    
    <div id="content" class="small-8 large-9 columns">
        
            
  <div class="section" id="preparing-to-migrate-sites-into-acquia-product-edg">
<h1>Preparing to migrate sites into Acquia Cloud Site Factory<a class="headerlink" href="#preparing-to-migrate-sites-into-acquia-product-edg" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="message-status docutils container">
<strong>ADVANCED</strong> - Incorrectly migrating a website without properly preparing for the attempt can involve data loss or a website outage event.</div>
<div class="internal-navigation docutils container">
<p><strong>Configuring and using Site Factory</strong></p>
<ul class="simple">
<li><a class="reference internal" href="setup.html"><span class="doc">Setup</span></a></li>
<li>Migrate</li>
<li><a class="reference internal" href="manage.html"><span class="doc">Manage</span></a></li>
<li><a class="reference internal" href="workflow.html"><span class="doc">Workflow</span></a></li>
<li><a class="reference internal" href="extend.html"><span class="doc">Extend</span></a></li>
<li><a class="reference internal" href="monitor.html"><span class="doc">Monitor</span></a></li>
</ul>
</div>
<p>Attempting to import an existing Drupal website into
Acquia Cloud Site Factory both requires that you understand how
Acquia Cloud Site Factory structures the websites that it hosts, and that you
complete the required preparatory work to ensure a smooth, repeatable
migration process, which can provide you a local backup of your work
should a rollback of your migration be needed.</p>
<p>The information on this page is intended as preparation for actually
<a class="reference external" href="/site-factory/migrate/execute">migrating your website into Acquia Cloud Site Factory</a>.</p>
<div class="section" id="checklist-for-website-migration">
<span id="checklist"></span><h2>Checklist for website migration<a class="headerlink" href="#checklist-for-website-migration" title="Permalink to this headline">¶</a></h2>
<p>Acquia has identified a common list of tasks to consider as part of your
initial sprint (Sprint 0) planning for an Acquia Cloud Site Factory
migration. Although the activities described <a class="reference external" href="/site-factory/migrate/plan">on the Sprint 0 checklist
page</a> are not a complete list, they can
help you to identify the work that is necessary for a successful launch,
and also identify the tools (such as <a class="reference external" href="/devtools/blt">Acquia BLT</a>) that can assist you.</p>
</div>
<div class="section" id="file-structure-in-acquia-product-edg">
<h2>File structure in Acquia Cloud Site Factory<a class="headerlink" href="#file-structure-in-acquia-product-edg" title="Permalink to this headline">¶</a></h2>
<p>When you are preparing to migrate a website, it helps to understand how
files are organized in a Acquia Cloud Site Factory installation. Migrating a
website into Acquia Cloud Site Factory involves all three major sections of a
Drupal website:</p>
<ul class="simple">
<li><a class="reference external" href="#shared-codebase-across-all-websites">Shared codebase across all websites</a></li>
<li><a class="reference external" href="#website-specific-files-directory">Website-specific files directory</a></li>
<li><a class="reference external" href="#per-website-theme-directory">Per-website theme directory</a></li>
</ul>
<div class="section" id="shared-codebase-across-all-websites">
<h3>Shared codebase across all websites<a class="headerlink" href="#shared-codebase-across-all-websites" title="Permalink to this headline">¶</a></h3>
<p>The code in your Factory’s main version control repository contains your
Drupal core and contributed module files that are to be used for all
websites in your Factory. You must use version control processes to
modify this code. Because storage and retrieval times are faster here
than in the distributed file storage system used in your
<a class="reference external" href="#structure-files">website-specific files directory</a>, Acquia
recommends that you store website-specific modules in one of the
following directories, based on your distribution:</p>
<ul class="simple">
<li>Using a distribution, such as <a class="reference external" href="/lightning">Lightning</a> - <code class="docutils literal"><span class="pre">profiles/[profilename]/modules</span></code></li>
<li><em>Not using a distribution</em> - Drupal 8: The top-level <code class="docutils literal"><span class="pre">modules</span></code> directory; Drupal 7: <code class="docutils literal"><span class="pre">sites/all/modules/</span></code></li>
</ul>
<p>Acquia discourages the use of the <code class="docutils literal"><span class="pre">sites/default</span></code> directory, with the
exception of <code class="docutils literal"><span class="pre">sites/default/files</span></code>, as files in <code class="docutils literal"><span class="pre">sites/default</span></code> will
not be included in website backups.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For instructions regarding allowing your codebase access to sensitive credentials, passwords, or other private information, see <a class="reference external" href="/resource/secrets">Storing sensitive information outside of your codebase</a>.</p>
</div>
</div>
<div class="section" id="website-specific-files-directory">
<h3>Website-specific files directory<a class="headerlink" href="#website-specific-files-directory" title="Permalink to this headline">¶</a></h3>
<p>Your website’s <code class="docutils literal"><span class="pre">files</span></code> directory should contain the binary file assets
(images and videos) your website needs that cannot be easily stored in
version control. This <code class="docutils literal"><span class="pre">files</span></code> directory, and its contents, reside on a
writable, distributed file system shared by all of your
Acquia Cloud Site Factory-hosted websites. Because this file system is
external to your shared codebase, access times for files stored in your
<code class="docutils literal"><span class="pre">files</span></code> directory will be slower than access times for <a class="reference external" href="#structure-code">files stored in the shared codebase</a>.</p>
<p>The <code class="docutils literal"><span class="pre">files</span></code> directory for your website is located at
<code class="docutils literal"><span class="pre">sites/g/files/[abcde]</span></code>, where <code class="docutils literal"><span class="pre">[abcde]</span></code> is a random string.</p>
<p>Public files reside in the <code class="docutils literal"><span class="pre">sites/g/files/[abcde]/f/</span></code> directory.</p>
</div>
<div class="section" id="per-website-theme-directory">
<h3>Per-website theme directory<a class="headerlink" href="#per-website-theme-directory" title="Permalink to this headline">¶</a></h3>
<p>Your website-specific directories each contain a <code class="docutils literal"><span class="pre">themes</span></code> directory.
Acquia strongly encourages that you store your per-website themes in
this location, as storage and retrieval are far faster than the
distributed storage system used in your website-specific files
directory. For information about creating a theme repository for each of
your websites in Acquia Cloud Site Factory, see <a class="reference external" href="/site-factory/theme/external">Adding external themes to your site</a>.</p>
<p>If you configure a dedicated theme repository for a website,
<code class="docutils literal"><span class="pre">sites/g/files/[abcde]/themes/site</span></code> will be a symlink to local storage
for that repository.</p>
</div>
</div>
<div class="section" id="preparing-drush-aliases-for-the-import-process">
<h2>Preparing Drush aliases for the import process<a class="headerlink" href="#preparing-drush-aliases-for-the-import-process" title="Permalink to this headline">¶</a></h2>
<p>Because the import process uses
<a class="reference external" href="https://www.drupal.org/project/drush">Drush</a> commands, creating
Drush aliases for your target website allows you to execute Drush
commands without needing to sign in to your target website to copy files
using SSH.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You should use Drush 8 when deploying a Drupal 8 codebase, and Drush 6 when deploying a Drupal 7 codebase.</p>
</div>
<p>To configure your aliases to run the correct version of Drush, create a
Drush aliases file based on the following example, altering the code to
meet your needs:</p>
<div class="code php highlight-default"><div class="highlight"><pre><span></span>$aliases[&#39;acquia-cloud&#39;] = array(
 &#39;path-aliases&#39; =&gt; array(
  // &#39;%drush-script&#39; =&gt; &#39;drush8&#39;, // uncomment this line if deploying a D8 codebase
  // &#39;%drush-script&#39; =&gt; &#39;drush6&#39;, // uncomment this line if deploying a D7 codebase.
   &#39;%dump-dir&#39; =&gt; &#39;/mnt/tmp/&#39;,
 ),
);
$aliases[&#39;target&#39;] = array(
 &#39;parent&#39; =&gt; &#39;@acquia-cloud&#39;,
 &#39;uri&#39; =&gt; &#39;mynewdomain.customername.acsitefactory.com&#39;,
 &#39;root&#39; =&gt; &#39;/var/www/html/AH_SITE_GROUP.AH_SITE_ENVIRONMENT/docroot/&#39;,
 &#39;remote-host&#39; =&gt; &#39;managed-12345.defaultrealm.hosting.acquia.com&#39;,
 &#39;remote-user&#39; =&gt; &#39;YOURUSERNAMEHERE&#39;,
 &#39;path-aliases&#39; =&gt; array(
   # the following is optional if you want to have a dedicated temp dir without many other files in there:
   &#39;%dump-dir&#39; =&gt; &#39;/mnt/tmp/AH_SITE_GROUP.AH_SITE_ENVIRONMENT/drush-import/&#39;,
 ),
);
</pre></div>
</div>
<p>If you need assistance determining what these values should be, <a class="reference external" href="/support#contact">contact Acquia Support</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The instructions in the website migration process that reference the <code class="docutils literal"><span class="pre">&#64;target</span></code> alias assume you have created and implemented this file, and will execute <code class="docutils literal"><span class="pre">&#64;target</span></code> commands from your local computer to affect your intended target website.</p>
</div>
<p>To verify that your Drush aliases are functioning properly, from a
command line window, run the following command:</p>
<p><code class="docutils literal"><span class="pre">drush</span> <span class="pre">&#64;target</span> <span class="pre">status</span></code></p>
<p>Examine both the <strong>Site path</strong> to determine if it matches the path
<code class="docutils literal"><span class="pre">sites/g/files/[abcde]</span></code> (where <code class="docutils literal"><span class="pre">[abcde]</span></code> is a random string), and
the <strong>File directory path</strong> to determine if it matches
<code class="docutils literal"><span class="pre">sites/g/files/[abcde]/f</span></code> (where <code class="docutils literal"><span class="pre">[abcde]</span></code> is a random string).</p>
<p>If your both the <strong>Site path</strong> and <strong>File directory path</strong> values match
the described strings, your Drush aliases are connecting to your server.</p>
<p>Common sources of problems with this file include the following:</p>
<ul class="simple">
<li>Incorrect values for <code class="docutils literal"><span class="pre">uri</span></code>, <code class="docutils literal"><span class="pre">remote_host</span></code>, or <code class="docutils literal"><span class="pre">remote-user</span></code></li>
<li>Not committing the <code class="docutils literal"><span class="pre">sites/g/</span></code> directory to the codebase after
executing <code class="docutils literal"><span class="pre">drush</span> <span class="pre">acsf-init</span></code></li>
</ul>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>After you ensure that your website will work with the Acquia Cloud Site Factory directory structure and you test your Drush aliases, you should review the <a class="reference external" href="/site-factory/migrate/plan">Checklist for migrating your sites</a> to Acquia Cloud Site Factory.</p>
</div>
</div>


        
    </div>
</div>

    
<div class="row">
    <div class="small-4 large-3 columns"></div>
    <div id="relinks" class="small-8 large-9 columns">
        <div class="pagination-wrapper">
            <div class="prev">
                <a href="monitor/auditlog.html" title="Auditing Acquia Cloud Site Factory events"><b>‹&nbsp;</b>Auditing Acquia Cloud Site Factory events</a>
            </div>
            
            <div class="next">
                <a href="migrate/execute.html" title="Executing a migration into Acquia Cloud Site Factory">Executing a migration into Acquia Cloud Site Factory<b>&nbsp;›</b></a>
            </div>
            
        </div>
    </div>
</div>



    
<div class="assistance-wrapper">
	<div class="assistance-tbl">
		<div class="col">
			<p><img src="/_static/phone.png" alt="Contact support">Still need assistance? <strong><a href="https://docs.acquia.com/support">Contact Acquia Support</a></strong></p>
		</div>
	</div>
</div>
<div class="support">
	<div class="support-tbl">
		<div class="col left">
			<h2><a href="https://www.acquia.com/customer-success/acquia-global-support">Support</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/support">Contact Support</a></li>
			</ul>
		</div>
		<div class="col middle">
			<h2><a href="https://www.acquia.com/about-us">About Acquia</a></h2>
			<ul class="no-bullet">
				<li><a class="light-link" href="https://www.acquia.com/about-us">About Us</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/leadership">Leadership</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/board">Board of Directors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/investors">Investors</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/newsroom">Newsroom</a></li>
				<li><a class="light-link" href="https://www.acquia.com/careers">Careers</a></li>
				<li><a class="light-link" href="https://www.acquia.com/about-us/contact">Contact Us</a></li>
			</ul>
			<ul class="social-media">
				<li>
					<a class="fa fa-twitter fa-lg ext" href="https://twitter.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Twitter</span>
					</a>
				</li>
				<li>
					<a class="fa fa-facebook fa-lg ext" href="https://www.facebook.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Facebook</span>
					</a>
				</li>
				<li>
					<a class="fa fa-github-alt fa-lg ext" href="https://github.com/acquia" target="_blank" rel="nofollow">
						<span class="hide">Github</span>
					</a>
				</li>
				<li>
					<a class="fa fa-linkedin-in fa-lg ext" href="http://www.linkedin.com/company/167056" target="_blank" rel="nofollow">
						<span class="hide">LinkedIn</span>
					</a>
				</li>
				<li>
					<a class="fa fa-google-plus-g fa-lg ext" href="https://plus.google.com/+acquia" target="_blank" rel="nofollow">
						<span class="hide">Google+</span>
					</a>
				</li>
				<li>
					<a class="fa fa-play fa-lg ext" href="https://www.youtube.com/user/AcquiaTV" target="_blank" rel="nofollow">
						<span class="hide">YouTube</span>
					</a>
				</li>
				<li>
					<a class="fa fa-envelope fa-lg" href="https://www.acquia.com/about-us/contact">
						<span class="hide">Contact Us</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="col right">
			<div class="centered">
				<p>
					<img alt="Acquia: Think Ahead" src="/_static/acquia-logo-think-ahead-black-small.svg">
				</p>
				<p class="margin-left-half">
					<span>53 State Street, 10th Floor<br>
					Boston, MA 02109<br>
					United States<br>
					Phone: 888-922-7842</span><br>
					Map: <a class="decorate ext" href="http://maps.google.com/?q=42.358429+-71.056184+%2853+State+Street%2C+10th+Floor%2C+Boston%2C+MA%2C+02109%2C+us%29" target="_blank" rel="nofollow">Google Maps<span class="ext"><span class="element-invisible"> </span></span></a><br><a class="decorate" href="https://www.acquia.com/about-us/contact#block-views-locations-block-1">View other locations</a>
				</p>
			</div>
		</div>
	</div>
</div>
<div class="top-bar row column">
	<div class="footer" role="contentinfo">Copyright &copy 2018 Acquia Inc. All Rights Reserved. </br>Drupal is a registered trademark of <a href="https://dri.es/">Dries Buytaert</a>. All product names, logos, and brands are property of their respective owners.
    </div>
</div>
    </div>

    <script> $(document).foundation() </script>
    <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

      _st('install','2_Wi1aQvEeu61haxG8TX','2.0.0');
    </script>

  </body>
</html>